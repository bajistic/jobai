# Job Filtering Optimization Test API

This API provides a testing endpoint to compare the original and optimized job filtering approaches.

## Endpoints

### `GET /api/jobs/test-optimization`

Tests and compares the original and optimized job filtering approaches for a specific job or a batch of jobs.

**Query Parameters:**
- `jobId`: Specific job ID to test (optional)
- `limit`: Number of jobs to test (default: 5, only used if jobId not provided)

**Response for a single job:**
```json
{
  "jobId": 12345,
  "title": "Software Developer",
  "originalMethod": {
    "ranking": "good",
    "canton": "ZH"
  },
  "optimizedMethod": {
    "ranking": "good",
    "canton": "ZH"
  },
  "match": true
}
```

**Response for multiple jobs:**
```json
{
  "results": [
    {
      "jobId": 12345,
      "title": "Software Developer",
      "originalMethod": { "ranking": "good", "canton": "ZH" },
      "optimizedMethod": { "ranking": "good", "canton": "ZH" },
      "match": true
    },
    {
      "jobId": 12346,
      "title": "Web Designer",
      "originalMethod": { "ranking": "bingo", "canton": "BE" },
      "optimizedMethod": { "ranking": "good", "canton": "BE" },
      "match": false
    }
  ],
  "summary": {
    "total": 2,
    "matches": 1,
    "matchPercentage": "50.00%"
  }
}
```

## Purpose

This endpoint is designed for development and validation purposes to:

1. Compare the rankings generated by the original per-user approach and the new optimized approach
2. Calculate the match percentage to verify that the new approach produces comparable results
3. Measure performance differences between the two approaches
4. Help tune and refine the personalization algorithm

## Implementation Details

The test endpoint:
1. Retrieves the specified job(s)
2. Calls both the original `rankJob()` method and the optimized `rankJobHybrid()` method
3. Reports the results from both methods and whether they match
4. For multiple jobs, calculates summary statistics

## Usage Recommendation

This endpoint should primarily be used during development and testing, not in production, as it makes duplicate API calls to OpenAI for comparison purposes.